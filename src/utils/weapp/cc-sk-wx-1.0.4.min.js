var dbits,b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=";function hex2b64(t){var i,n,e="";for(i=0;i+3<=t.length;i+=3)n=parseInt(t.substring(i,i+3),16),e+=b64map.charAt(n>>6)+b64map.charAt(63&n);if(i+1==t.length?(n=parseInt(t.substring(i,i+1),16),e+=b64map.charAt(n<<2)):i+2==t.length&&(n=parseInt(t.substring(i,i+2),16),e+=b64map.charAt(n>>2)+b64map.charAt((3&n)<<4)),b64pad)for(;0<(3&e.length);)e+=b64pad;return e}function b64tohex(t){var i,n,e,r="",o=0;for(i=0;i<t.length&&t.charAt(i)!=b64pad;++i)(e=b64map.indexOf(t.charAt(i)))<0||(o=0==o?(r+=int2char(e>>2),n=3&e,1):1==o?(r+=int2char(n<<2|e>>4),n=15&e,2):2==o?(r+=int2char(n),r+=int2char(e>>2),n=3&e,3):(r+=int2char(n<<2|e>>4),r+=int2char(15&e),0));return 1==o&&(r+=int2char(n<<2)),r}function b64toBA(t){var i,n=b64tohex(t),e=new Array;for(i=0;2*i<n.length;++i)e[i]=parseInt(n.substring(2*i,2*i+2),16);return e}var canary=0xdeadbeefcafe,j_lm=15715070==(16777215&canary);function BigInteger(t,i,n){null!=t&&("number"==typeof t?this.fromNumber(t,i,n):null==i&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,i))}function nbi(){return new BigInteger(null)}function am1(t,i,n,e,r,o){for(;0<=--o;){var s=i*this[t++]+n[e]+r;r=Math.floor(s/67108864),n[e++]=67108863&s}return r}function am2(t,i,n,e,r,o){for(var s=32767&i,a=i>>15;0<=--o;){var h=32767&this[t],c=this[t++]>>15,u=a*h+c*s;r=((h=s*h+((32767&u)<<15)+n[e]+(1073741823&r))>>>30)+(u>>>15)+a*c+(r>>>30),n[e++]=1073741823&h}return r}function am3(t,i,n,e,r,o){for(var s=16383&i,a=i>>14;0<=--o;){var h=16383&this[t],c=this[t++]>>14,u=a*h+c*s;r=((h=s*h+((16383&u)<<14)+n[e]+r)>>28)+(u>>14)+a*c,n[e++]=268435455&h}return r}BigInteger.prototype.am=am3,dbits=28,BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var rr,BI_RM="0123456789abcdefghijklmnopqrstuvwxyz",BI_RC=new Array;rr="0".charCodeAt(0);for(var vv=0;vv<=9;++vv)BI_RC[rr++]=vv;rr="a".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;rr="A".charCodeAt(0);for(vv=10;vv<36;++vv)BI_RC[rr++]=vv;function int2char(t){return BI_RM.charAt(t)}function intAt(t,i){var n=BI_RC[t.charCodeAt(i)];return null==n?-1:n}function bnpCopyTo(t){for(var i=this.t-1;0<=i;--i)t[i]=this[i];t.t=this.t,t.s=this.s}function bnpFromInt(t){this.t=1,this.s=t<0?-1:0,0<t?this[0]=t:t<-1?this[0]=t+DV:this.t=0}function nbv(t){var i=nbi();return i.fromInt(t),i}function bnpFromString(t,i){var n;if(16==i)n=4;else if(8==i)n=3;else if(256==i)n=8;else if(2==i)n=1;else if(32==i)n=5;else{if(4!=i)return void this.fromRadix(t,i);n=2}this.t=0,this.s=0;for(var e=t.length,r=!1,o=0;0<=--e;){var s=8==n?255&t[e]:intAt(t,e);s<0?"-"==t.charAt(e)&&(r=!0):(r=!1,0==o?this[this.t++]=s:o+n>this.DB?(this[this.t-1]|=(s&(1<<this.DB-o)-1)<<o,this[this.t++]=s>>this.DB-o):this[this.t-1]|=s<<o,(o+=n)>=this.DB&&(o-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,0<o&&(this[this.t-1]|=(1<<this.DB-o)-1<<o)),this.clamp(),r&&BigInteger.ZERO.subTo(this,this)}function bnpClamp(){for(var t=this.s&this.DM;0<this.t&&this[this.t-1]==t;)--this.t}function bnToString(t){if(this.s<0)return"-"+this.negate().toString(t);var i;if(16==t)i=4;else if(8==t)i=3;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return this.toRadix(t);i=2}var n,e=(1<<i)-1,r=!1,o="",s=this.t,a=this.DB-s*this.DB%i;if(0<s--)for(a<this.DB&&0<(n=this[s]>>a)&&(r=!0,o=int2char(n));0<=s;)a<i?(n=(this[s]&(1<<a)-1)<<i-a,n|=this[--s]>>(a+=this.DB-i)):(n=this[s]>>(a-=i)&e,a<=0&&(a+=this.DB,--s)),0<n&&(r=!0),r&&(o+=int2char(n));return r?o:"0"}function bnNegate(){var t=nbi();return BigInteger.ZERO.subTo(this,t),t}function bnAbs(){return this.s<0?this.negate():this}function bnCompareTo(t){var i=this.s-t.s;if(0!=i)return i;var n=this.t;if(0!=(i=n-t.t))return this.s<0?-i:i;for(;0<=--n;)if(0!=(i=this[n]-t[n]))return i;return 0}function nbits(t){var i,n=1;return 0!=(i=t>>>16)&&(t=i,n+=16),0!=(i=t>>8)&&(t=i,n+=8),0!=(i=t>>4)&&(t=i,n+=4),0!=(i=t>>2)&&(t=i,n+=2),0!=(i=t>>1)&&(t=i,n+=1),n}function bnBitLength(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)}function bnpDLShiftTo(t,i){var n;for(n=this.t-1;0<=n;--n)i[n+t]=this[n];for(n=t-1;0<=n;--n)i[n]=0;i.t=this.t+t,i.s=this.s}function bnpDRShiftTo(t,i){for(var n=t;n<this.t;++n)i[n-t]=this[n];i.t=Math.max(this.t-t,0),i.s=this.s}function bnpLShiftTo(t,i){var n,e=t%this.DB,r=this.DB-e,o=(1<<r)-1,s=Math.floor(t/this.DB),a=this.s<<e&this.DM;for(n=this.t-1;0<=n;--n)i[n+s+1]=this[n]>>r|a,a=(this[n]&o)<<e;for(n=s-1;0<=n;--n)i[n]=0;i[s]=a,i.t=this.t+s+1,i.s=this.s,i.clamp()}function bnpRShiftTo(t,i){i.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)i.t=0;else{var e=t%this.DB,r=this.DB-e,o=(1<<e)-1;i[0]=this[n]>>e;for(var s=n+1;s<this.t;++s)i[s-n-1]|=(this[s]&o)<<r,i[s-n]=this[s]>>e;0<e&&(i[this.t-n-1]|=(this.s&o)<<r),i.t=this.t-n,i.clamp()}}function bnpSubTo(t,i){for(var n=0,e=0,r=Math.min(t.t,this.t);n<r;)e+=this[n]-t[n],i[n++]=e&this.DM,e>>=this.DB;if(t.t<this.t){for(e-=t.s;n<this.t;)e+=this[n],i[n++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;n<t.t;)e-=t[n],i[n++]=e&this.DM,e>>=this.DB;e-=t.s}i.s=e<0?-1:0,e<-1?i[n++]=this.DV+e:0<e&&(i[n++]=e),i.t=n,i.clamp()}function bnpMultiplyTo(t,i){var n=this.abs(),e=t.abs(),r=n.t;for(i.t=r+e.t;0<=--r;)i[r]=0;for(r=0;r<e.t;++r)i[r+n.t]=n.am(0,e[r],i,r,0,n.t);i.s=0,i.clamp(),this.s!=t.s&&BigInteger.ZERO.subTo(i,i)}function bnpSquareTo(t){for(var i=this.abs(),n=t.t=2*i.t;0<=--n;)t[n]=0;for(n=0;n<i.t-1;++n){var e=i.am(n,i[n],t,2*n,0,1);(t[n+i.t]+=i.am(n+1,2*i[n],t,2*n+1,e,i.t-n-1))>=i.DV&&(t[n+i.t]-=i.DV,t[n+i.t+1]=1)}0<t.t&&(t[t.t-1]+=i.am(n,i[n],t,2*n,0,1)),t.s=0,t.clamp()}function bnpDivRemTo(t,i,n){var e=t.abs();if(!(e.t<=0)){var r=this.abs();if(r.t<e.t)return null!=i&&i.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=nbi());var o=nbi(),s=this.s,a=t.s,h=this.DB-nbits(e[e.t-1]);0<h?(e.lShiftTo(h,o),r.lShiftTo(h,n)):(e.copyTo(o),r.copyTo(n));var c=o.t,u=o[c-1];if(0!=u){var p=u*(1<<this.F1)+(1<c?o[c-2]>>this.F2:0),l=this.FV/p,f=(1<<this.F1)/p,g=1<<this.F2,d=n.t,_=d-c,b=null==i?nbi():i;for(o.dlShiftTo(_,b),0<=n.compareTo(b)&&(n[n.t++]=1,n.subTo(b,n)),BigInteger.ONE.dlShiftTo(c,b),b.subTo(o,o);o.t<c;)o[o.t++]=0;for(;0<=--_;){var m=n[--d]==u?this.DM:Math.floor(n[d]*l+(n[d-1]+g)*f);if((n[d]+=o.am(0,m,n,_,0,c))<m)for(o.dlShiftTo(_,b),n.subTo(b,n);n[d]<--m;)n.subTo(b,n)}null!=i&&(n.drShiftTo(c,i),s!=a&&BigInteger.ZERO.subTo(i,i)),n.t=c,n.clamp(),0<h&&n.rShiftTo(h,n),s<0&&BigInteger.ZERO.subTo(n,n)}}}function bnMod(t){var i=nbi();return this.abs().divRemTo(t,null,i),this.s<0&&0<i.compareTo(BigInteger.ZERO)&&t.subTo(i,i),i}function Classic(t){this.m=t}function cConvert(t){return t.s<0||0<=t.compareTo(this.m)?t.mod(this.m):t}function cRevert(t){return t}function cReduce(t){t.divRemTo(this.m,null,t)}function cMulTo(t,i,n){t.multiplyTo(i,n),this.reduce(n)}function cSqrTo(t,i){t.squareTo(i),this.reduce(i)}function bnpInvDigit(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var i=3&t;return 0<(i=(i=(i=(i=i*(2-(15&t)*i)&15)*(2-(255&t)*i)&255)*(2-((65535&t)*i&65535))&65535)*(2-t*i%this.DV)%this.DV)?this.DV-i:-i}function Montgomery(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function montConvert(t){var i=nbi();return t.abs().dlShiftTo(this.m.t,i),i.divRemTo(this.m,null,i),t.s<0&&0<i.compareTo(BigInteger.ZERO)&&this.m.subTo(i,i),i}function montRevert(t){var i=nbi();return t.copyTo(i),this.reduce(i),i}function montReduce(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var i=0;i<this.m.t;++i){var n=32767&t[i],e=n*this.mpl+((n*this.mph+(t[i]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=i+this.m.t]+=this.m.am(0,e,t,i,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),0<=t.compareTo(this.m)&&t.subTo(this.m,t)}function montSqrTo(t,i){t.squareTo(i),this.reduce(i)}function montMulTo(t,i,n){t.multiplyTo(i,n),this.reduce(n)}function bnpIsEven(){return 0==(0<this.t?1&this[0]:this.s)}function bnpExp(t,i){if(4294967295<t||t<1)return BigInteger.ONE;var n=nbi(),e=nbi(),r=i.convert(this),o=nbits(t)-1;for(r.copyTo(n);0<=--o;)if(i.sqrTo(n,e),0<(t&1<<o))i.mulTo(e,r,n);else{var s=n;n=e,e=s}return i.revert(n)}function bnModPowInt(t,i){var n;return n=t<256||i.isEven()?new Classic(i):new Montgomery(i),this.exp(t,n)}function bnClone(){var t=nbi();return this.copyTo(t),t}function bnIntValue(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function bnByteValue(){return 0==this.t?this.s:this[0]<<24>>24}function bnShortValue(){return 0==this.t?this.s:this[0]<<16>>16}function bnpChunkSize(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function bnSigNum(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1}function bnpToRadix(t){if(null==t&&(t=10),0==this.signum()||t<2||36<t)return"0";var i=this.chunkSize(t),n=Math.pow(t,i),e=nbv(n),r=nbi(),o=nbi(),s="";for(this.divRemTo(e,r,o);0<r.signum();)s=(n+o.intValue()).toString(t).substr(1)+s,r.divRemTo(e,r,o);return o.intValue().toString(t)+s}function bnpFromRadix(t,i){this.fromInt(0),null==i&&(i=10);for(var n=this.chunkSize(i),e=Math.pow(i,n),r=!1,o=0,s=0,a=0;a<t.length;++a){var h=intAt(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(s=i*s+h,++o>=n&&(this.dMultiply(e),this.dAddOffset(s,0),s=o=0))}0<o&&(this.dMultiply(Math.pow(i,o)),this.dAddOffset(s,0)),r&&BigInteger.ZERO.subTo(this,this)}function bnpFromNumber(t,i,n){if("number"==typeof i)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(BigInteger.ONE.shiftLeft(t-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(i);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(BigInteger.ONE.shiftLeft(t-1),this);else{var e=new Array,r=7&t;e.length=1+(t>>3),i.nextBytes(e),0<r?e[0]&=(1<<r)-1:e[0]=0,this.fromString(e,256)}}function bnToByteArray(){var t=this.t,i=new Array;i[0]=this.s;var n,e=this.DB-t*this.DB%8,r=0;if(0<t--)for(e<this.DB&&(n=this[t]>>e)!=(this.s&this.DM)>>e&&(i[r++]=n|this.s<<this.DB-e);0<=t;)e<8?(n=(this[t]&(1<<e)-1)<<8-e,n|=this[--t]>>(e+=this.DB-8)):(n=this[t]>>(e-=8)&255,e<=0&&(e+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(0<r||n!=this.s)&&(i[r++]=n);return i}function bnEquals(t){return 0==this.compareTo(t)}function bnMin(t){return this.compareTo(t)<0?this:t}function bnMax(t){return 0<this.compareTo(t)?this:t}function bnpBitwiseTo(t,i,n){var e,r,o=Math.min(t.t,this.t);for(e=0;e<o;++e)n[e]=i(this[e],t[e]);if(t.t<this.t){for(r=t.s&this.DM,e=o;e<this.t;++e)n[e]=i(this[e],r);n.t=this.t}else{for(r=this.s&this.DM,e=o;e<t.t;++e)n[e]=i(r,t[e]);n.t=t.t}n.s=i(this.s,t.s),n.clamp()}function op_and(t,i){return t&i}function bnAnd(t){var i=nbi();return this.bitwiseTo(t,op_and,i),i}function op_or(t,i){return t|i}function bnOr(t){var i=nbi();return this.bitwiseTo(t,op_or,i),i}function op_xor(t,i){return t^i}function bnXor(t){var i=nbi();return this.bitwiseTo(t,op_xor,i),i}function op_andnot(t,i){return t&~i}function bnAndNot(t){var i=nbi();return this.bitwiseTo(t,op_andnot,i),i}function bnNot(){for(var t=nbi(),i=0;i<this.t;++i)t[i]=this.DM&~this[i];return t.t=this.t,t.s=~this.s,t}function bnShiftLeft(t){var i=nbi();return t<0?this.rShiftTo(-t,i):this.lShiftTo(t,i),i}function bnShiftRight(t){var i=nbi();return t<0?this.lShiftTo(-t,i):this.rShiftTo(t,i),i}function lbit(t){if(0==t)return-1;var i=0;return 0==(65535&t)&&(t>>=16,i+=16),0==(255&t)&&(t>>=8,i+=8),0==(15&t)&&(t>>=4,i+=4),0==(3&t)&&(t>>=2,i+=2),0==(1&t)&&++i,i}function bnGetLowestSetBit(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+lbit(this[t]);return this.s<0?this.t*this.DB:-1}function cbit(t){for(var i=0;0!=t;)t&=t-1,++i;return i}function bnBitCount(){for(var t=0,i=this.s&this.DM,n=0;n<this.t;++n)t+=cbit(this[n]^i);return t}function bnTestBit(t){var i=Math.floor(t/this.DB);return i>=this.t?0!=this.s:0!=(this[i]&1<<t%this.DB)}function bnpChangeBit(t,i){var n=BigInteger.ONE.shiftLeft(t);return this.bitwiseTo(n,i,n),n}function bnSetBit(t){return this.changeBit(t,op_or)}function bnClearBit(t){return this.changeBit(t,op_andnot)}function bnFlipBit(t){return this.changeBit(t,op_xor)}function bnpAddTo(t,i){for(var n=0,e=0,r=Math.min(t.t,this.t);n<r;)e+=this[n]+t[n],i[n++]=e&this.DM,e>>=this.DB;if(t.t<this.t){for(e+=t.s;n<this.t;)e+=this[n],i[n++]=e&this.DM,e>>=this.DB;e+=this.s}else{for(e+=this.s;n<t.t;)e+=t[n],i[n++]=e&this.DM,e>>=this.DB;e+=t.s}i.s=e<0?-1:0,0<e?i[n++]=e:e<-1&&(i[n++]=this.DV+e),i.t=n,i.clamp()}function bnAdd(t){var i=nbi();return this.addTo(t,i),i}function bnSubtract(t){var i=nbi();return this.subTo(t,i),i}function bnMultiply(t){var i=nbi();return this.multiplyTo(t,i),i}function bnSquare(){var t=nbi();return this.squareTo(t),t}function bnDivide(t){var i=nbi();return this.divRemTo(t,i,null),i}function bnRemainder(t){var i=nbi();return this.divRemTo(t,null,i),i}function bnDivideAndRemainder(t){var i=nbi(),n=nbi();return this.divRemTo(t,i,n),new Array(i,n)}function bnpDMultiply(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function bnpDAddOffset(t,i){if(0!=t){for(;this.t<=i;)this[this.t++]=0;for(this[i]+=t;this[i]>=this.DV;)this[i]-=this.DV,++i>=this.t&&(this[this.t++]=0),++this[i]}}function NullExp(){}function nNop(t){return t}function nMulTo(t,i,n){t.multiplyTo(i,n)}function nSqrTo(t,i){t.squareTo(i)}function bnPow(t){return this.exp(t,new NullExp)}function bnpMultiplyLowerTo(t,i,n){var e,r=Math.min(this.t+t.t,i);for(n.s=0,n.t=r;0<r;)n[--r]=0;for(e=n.t-this.t;r<e;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(e=Math.min(t.t,i);r<e;++r)this.am(0,t[r],n,r,0,i-r);n.clamp()}function bnpMultiplyUpperTo(t,i,n){--i;var e=n.t=this.t+t.t-i;for(n.s=0;0<=--e;)n[e]=0;for(e=Math.max(i-this.t,0);e<t.t;++e)n[this.t+e-i]=this.am(i-e,t[e],n,0,0,this.t+e-i);n.clamp(),n.drShiftTo(1,n)}function Barrett(t){this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function barrettConvert(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var i=nbi();return t.copyTo(i),this.reduce(i),i}function barrettRevert(t){return t}function barrettReduce(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);0<=t.compareTo(this.m);)t.subTo(this.m,t)}function barrettSqrTo(t,i){t.squareTo(i),this.reduce(i)}function barrettMulTo(t,i,n){t.multiplyTo(i,n),this.reduce(n)}function bnModPow(t,i){var n,e,r=t.bitLength(),o=nbv(1);if(r<=0)return o;n=r<18?1:r<48?3:r<144?4:r<768?5:6,e=r<8?new Classic(i):i.isEven()?new Barrett(i):new Montgomery(i);var s=new Array,a=3,h=n-1,c=(1<<n)-1;if(s[1]=e.convert(this),1<n){var u=nbi();for(e.sqrTo(s[1],u);a<=c;)s[a]=nbi(),e.mulTo(u,s[a-2],s[a]),a+=2}var p,l,f=t.t-1,g=!0,d=nbi();for(r=nbits(t[f])-1;0<=f;){for(h<=r?p=t[f]>>r-h&c:(p=(t[f]&(1<<r+1)-1)<<h-r,0<f&&(p|=t[f-1]>>this.DB+r-h)),a=n;0==(1&p);)p>>=1,--a;if((r-=a)<0&&(r+=this.DB,--f),g)s[p].copyTo(o),g=!1;else{for(;1<a;)e.sqrTo(o,d),e.sqrTo(d,o),a-=2;0<a?e.sqrTo(o,d):(l=o,o=d,d=l),e.mulTo(d,s[p],o)}for(;0<=f&&0==(t[f]&1<<r);)e.sqrTo(o,d),l=o,o=d,d=l,--r<0&&(r=this.DB-1,--f)}return e.revert(o)}function bnGCD(t){var i=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(i.compareTo(n)<0){var e=i;i=n,n=e}var r=i.getLowestSetBit(),o=n.getLowestSetBit();if(o<0)return i;for(r<o&&(o=r),0<o&&(i.rShiftTo(o,i),n.rShiftTo(o,n));0<i.signum();)0<(r=i.getLowestSetBit())&&i.rShiftTo(r,i),0<(r=n.getLowestSetBit())&&n.rShiftTo(r,n),0<=i.compareTo(n)?(i.subTo(n,i),i.rShiftTo(1,i)):(n.subTo(i,n),n.rShiftTo(1,n));return 0<o&&n.lShiftTo(o,n),n}function bnpModInt(t){if(t<=0)return 0;var i=this.DV%t,n=this.s<0?t-1:0;if(0<this.t)if(0==i)n=this[0]%t;else for(var e=this.t-1;0<=e;--e)n=(i*n+this[e])%t;return n}function bnModInverse(t){var i=t.isEven();if(this.isEven()&&i||0==t.signum())return BigInteger.ZERO;for(var n=t.clone(),e=this.clone(),r=nbv(1),o=nbv(0),s=nbv(0),a=nbv(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),i?(r.isEven()&&o.isEven()||(r.addTo(this,r),o.subTo(t,o)),r.rShiftTo(1,r)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);for(;e.isEven();)e.rShiftTo(1,e),i?(s.isEven()&&a.isEven()||(s.addTo(this,s),a.subTo(t,a)),s.rShiftTo(1,s)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);0<=n.compareTo(e)?(n.subTo(e,n),i&&r.subTo(s,r),o.subTo(a,o)):(e.subTo(n,e),i&&s.subTo(r,s),a.subTo(o,a))}return 0!=e.compareTo(BigInteger.ONE)?BigInteger.ZERO:0<=a.compareTo(t)?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a}Classic.prototype.convert=cConvert,Classic.prototype.revert=cRevert,Classic.prototype.reduce=cReduce,Classic.prototype.mulTo=cMulTo,Classic.prototype.sqrTo=cSqrTo,Montgomery.prototype.convert=montConvert,Montgomery.prototype.revert=montRevert,Montgomery.prototype.reduce=montReduce,Montgomery.prototype.mulTo=montMulTo,Montgomery.prototype.sqrTo=montSqrTo,BigInteger.prototype.copyTo=bnpCopyTo,BigInteger.prototype.fromInt=bnpFromInt,BigInteger.prototype.fromString=bnpFromString,BigInteger.prototype.clamp=bnpClamp,BigInteger.prototype.dlShiftTo=bnpDLShiftTo,BigInteger.prototype.drShiftTo=bnpDRShiftTo,BigInteger.prototype.lShiftTo=bnpLShiftTo,BigInteger.prototype.rShiftTo=bnpRShiftTo,BigInteger.prototype.subTo=bnpSubTo,BigInteger.prototype.multiplyTo=bnpMultiplyTo,BigInteger.prototype.squareTo=bnpSquareTo,BigInteger.prototype.divRemTo=bnpDivRemTo,BigInteger.prototype.invDigit=bnpInvDigit,BigInteger.prototype.isEven=bnpIsEven,BigInteger.prototype.exp=bnpExp,BigInteger.prototype.toString=bnToString,BigInteger.prototype.negate=bnNegate,BigInteger.prototype.abs=bnAbs,BigInteger.prototype.compareTo=bnCompareTo,BigInteger.prototype.bitLength=bnBitLength,BigInteger.prototype.mod=bnMod,BigInteger.prototype.modPowInt=bnModPowInt,BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1),NullExp.prototype.convert=nNop,NullExp.prototype.revert=nNop,NullExp.prototype.mulTo=nMulTo,NullExp.prototype.sqrTo=nSqrTo,Barrett.prototype.convert=barrettConvert,Barrett.prototype.revert=barrettRevert,Barrett.prototype.reduce=barrettReduce,Barrett.prototype.mulTo=barrettMulTo,Barrett.prototype.sqrTo=barrettSqrTo;var lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1];function bnIsProbablePrime(t){var i,n=this.abs();if(1==n.t&&n[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(n[0]==lowprimes[i])return!0;return!1}if(n.isEven())return!1;for(i=1;i<lowprimes.length;){for(var e=lowprimes[i],r=i+1;r<lowprimes.length&&e<lplim;)e*=lowprimes[r++];for(e=n.modInt(e);i<r;)if(e%lowprimes[i++]==0)return!1}return n.millerRabin(t)}function bnpMillerRabin(t){var i=this.subtract(BigInteger.ONE),n=i.getLowestSetBit();if(n<=0)return!1;var e=i.shiftRight(n);(t=t+1>>1)>lowprimes.length&&(t=lowprimes.length);for(var r=nbi(),o=0;o<t;++o){r.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var s=r.modPow(e,this);if(0!=s.compareTo(BigInteger.ONE)&&0!=s.compareTo(i)){for(var a=1;a++<n&&0!=s.compareTo(i);)if(0==(s=s.modPowInt(2,this)).compareTo(BigInteger.ONE))return!1;if(0!=s.compareTo(i))return!1}}return!0}function sha1(t){var i=[1518500249,1859775393,2400959708,3395469782];t+=String.fromCharCode(128);for(var n=Math.ceil(t.length/4)+2,e=Math.ceil(n/16),r=new Array(e),o=0;o<e;o++){r[o]=new Array(16);for(var s=0;s<16;s++)r[o][s]=t.charCodeAt(64*o+4*s)<<24|t.charCodeAt(64*o+4*s+1)<<16|t.charCodeAt(64*o+4*s+2)<<8|t.charCodeAt(64*o+4*s+3)}r[e-1][14]=8*(t.length-1)/Math.pow(2,32),r[e-1][14]=Math.floor(r[e-1][14]),r[e-1][15]=8*(t.length-1)&4294967295;var a,h,c,u,p,l=1732584193,f=4023233417,g=2562383102,d=271733878,_=3285377520,b=new Array(80);for(o=0;o<e;o++){for(var m=0;m<16;m++)b[m]=r[o][m];for(m=16;m<80;m++)b[m]=b[m-3]^b[m-8]^b[m-14]^b[m-16],b[m]=b[m]<<1|b[m]>>>31;a=l,h=f,c=g,u=d,p=_;for(m=0;m<80;m++){var v=Math.floor(m/20),y=(a<<5|a>>>27)+p+i[v]+b[m];switch(v){case 0:y+=h&c^~h&u;break;case 1:y+=h^c^u;break;case 2:y+=h&c^h&u^c&u;break;case 3:y+=h^c^u}p=u,u=c,c=h<<30|h>>>2,h=a,a=y}l=l+a&4294967295,f=f+h&4294967295,g=g+c&4294967295,d=d+u&4294967295,_=_+p&4294967295}var B="";for(o=7;0<=o;o--){B+=(l>>>4*o&15).toString(16)}for(o=7;0<=o;o--){B+=(f>>>4*o&15).toString(16)}for(o=7;0<=o;o--){B+=(g>>>4*o&15).toString(16)}for(o=7;0<=o;o--){B+=(d>>>4*o&15).toString(16)}for(o=7;0<=o;o--){B+=(_>>>4*o&15).toString(16)}return B}function Arcfour(){this.i=0,this.j=0,this.S=new Array}function ARC4init(t){var i,n,e;for(i=0;i<256;++i)this.S[i]=i;for(i=n=0;i<256;++i)n=n+this.S[i]+t[i%t.length]&255,e=this.S[i],this.S[i]=this.S[n],this.S[n]=e;this.i=0,this.j=0}function ARC4next(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]}function prng_newstate(){return new Arcfour}BigInteger.prototype.chunkSize=bnpChunkSize,BigInteger.prototype.toRadix=bnpToRadix,BigInteger.prototype.fromRadix=bnpFromRadix,BigInteger.prototype.fromNumber=bnpFromNumber,BigInteger.prototype.bitwiseTo=bnpBitwiseTo,BigInteger.prototype.changeBit=bnpChangeBit,BigInteger.prototype.addTo=bnpAddTo,BigInteger.prototype.dMultiply=bnpDMultiply,BigInteger.prototype.dAddOffset=bnpDAddOffset,BigInteger.prototype.multiplyLowerTo=bnpMultiplyLowerTo,BigInteger.prototype.multiplyUpperTo=bnpMultiplyUpperTo,BigInteger.prototype.modInt=bnpModInt,BigInteger.prototype.millerRabin=bnpMillerRabin,BigInteger.prototype.clone=bnClone,BigInteger.prototype.intValue=bnIntValue,BigInteger.prototype.byteValue=bnByteValue,BigInteger.prototype.shortValue=bnShortValue,BigInteger.prototype.signum=bnSigNum,BigInteger.prototype.toByteArray=bnToByteArray,BigInteger.prototype.equals=bnEquals,BigInteger.prototype.min=bnMin,BigInteger.prototype.max=bnMax,BigInteger.prototype.and=bnAnd,BigInteger.prototype.or=bnOr,BigInteger.prototype.xor=bnXor,BigInteger.prototype.andNot=bnAndNot,BigInteger.prototype.not=bnNot,BigInteger.prototype.shiftLeft=bnShiftLeft,BigInteger.prototype.shiftRight=bnShiftRight,BigInteger.prototype.getLowestSetBit=bnGetLowestSetBit,BigInteger.prototype.bitCount=bnBitCount,BigInteger.prototype.testBit=bnTestBit,BigInteger.prototype.setBit=bnSetBit,BigInteger.prototype.clearBit=bnClearBit,BigInteger.prototype.flipBit=bnFlipBit,BigInteger.prototype.add=bnAdd,BigInteger.prototype.subtract=bnSubtract,BigInteger.prototype.multiply=bnMultiply,BigInteger.prototype.divide=bnDivide,BigInteger.prototype.remainder=bnRemainder,BigInteger.prototype.divideAndRemainder=bnDivideAndRemainder,BigInteger.prototype.modPow=bnModPow,BigInteger.prototype.modInverse=bnModInverse,BigInteger.prototype.pow=bnPow,BigInteger.prototype.gcd=bnGCD,BigInteger.prototype.isProbablePrime=bnIsProbablePrime,BigInteger.prototype.square=bnSquare,Arcfour.prototype.init=ARC4init,Arcfour.prototype.next=ARC4next;var rng_state,rng_pool,rng_pptr,rng_psize=256;function rng_seed_int(t){rng_pool[rng_pptr++]^=255&t,rng_pool[rng_pptr++]^=t>>8&255,rng_pool[rng_pptr++]^=t>>16&255,rng_pool[rng_pptr++]^=t>>24&255,rng_psize<=rng_pptr&&(rng_pptr-=rng_psize)}function rng_seed_time(){rng_seed_int((new Date).getTime())}if(null==rng_pool){var t;for(rng_pool=new Array,rng_pptr=0;rng_pptr<rng_psize;)t=Math.floor(65536*Math.random()),rng_pool[rng_pptr++]=t>>>8,rng_pool[rng_pptr++]=255&t;rng_pptr=0,rng_seed_time()}function rng_get_byte(){if(null==rng_state){rng_seed_time(),(rng_state=prng_newstate()).init(rng_pool);for(var t=0;t<rng_pool.length;++t)rng_pool[t]=0;t=0}return rng_state.next()}function rng_get_bytes(t){var i;for(i=0;i<t.length;++i)t[i]=rng_get_byte()}function SecureRandom(){}function parseBigInt(t,i){return new BigInteger(t,i)}function linebrk(t,i){for(var n="",e=0;e+i<t.length;)n+=t.substring(e,e+i)+"\n",e+=i;return n+t.substring(e,t.length)}function byte2Hex(t){return t<16?"0"+t.toString(16):t.toString(16)}function pkcs1pad2(t,i){if(i<t.length+11)return console.log("Message too long for RSA"),null;for(var n=new Array,e=t.length-1;0<=e&&0<i;){var r=t.charCodeAt(e--);r<128?n[--i]=r:127<r&&r<2048?(n[--i]=63&r|128,n[--i]=r>>6|192):(n[--i]=63&r|128,n[--i]=r>>6&63|128,n[--i]=r>>12|224)}n[--i]=0;for(var o=new SecureRandom,s=new Array;2<i;){for(s[0]=0;0==s[0];)o.nextBytes(s);n[--i]=s[0]}return n[--i]=2,n[--i]=0,new BigInteger(n)}function RSAKey(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function RSASetPublic(t,i){null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=parseBigInt(t,16),this.e=parseInt(i,16)):console.log("Invalid RSA public key")}function RSADoPublic(t){return t.modPowInt(this.e,this.n)}function RSAEncrypt(t){var i=pkcs1pad2(t,this.n.bitLength()+7>>3);if(null==i)return null;var n=this.doPublic(i);if(null==n)return null;var e=n.toString(16);return 0==(1&e.length)?e:"0"+e}function pkcs1unpad2(t,i){for(var n=t.toByteArray(),e=0;e<n.length&&0==n[e];)++e;if(n.length-e!=i-1||2!=n[e])return null;for(++e;0!=n[e];)if(++e>=n.length)return null;for(var r="";++e<n.length;){var o=255&n[e];o<128?r+=String.fromCharCode(o):191<o&&o<224?(r+=String.fromCharCode((31&o)<<6|63&n[e+1]),++e):(r+=String.fromCharCode((15&o)<<12|(63&n[e+1])<<6|63&n[e+2]),e+=2)}return r}function RSASetPrivate(t,i,n){null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=parseBigInt(t,16),this.e=parseInt(i,16),this.d=parseBigInt(n,16)):console.log("Invalid RSA private key")}function RSASetPrivateEx(t,i,n,e,r,o,s,a){null!=t&&null!=i&&0<t.length&&0<i.length?(this.n=parseBigInt(t,16),this.e=parseInt(i,16),this.d=parseBigInt(n,16),this.p=parseBigInt(e,16),this.q=parseBigInt(r,16),this.dmp1=parseBigInt(o,16),this.dmq1=parseBigInt(s,16),this.coeff=parseBigInt(a,16)):console.log("Invalid RSA private key")}function RSAGenerate(t,i){var n=new SecureRandom,e=t>>1;this.e=parseInt(i,16);for(var r=new BigInteger(i,16);;){for(;this.p=new BigInteger(t-e,1,n),0!=this.p.subtract(BigInteger.ONE).gcd(r).compareTo(BigInteger.ONE)||!this.p.isProbablePrime(10););for(;this.q=new BigInteger(e,1,n),0!=this.q.subtract(BigInteger.ONE).gcd(r).compareTo(BigInteger.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var o=this.p;this.p=this.q,this.q=o}var s=this.p.subtract(BigInteger.ONE),a=this.q.subtract(BigInteger.ONE),h=s.multiply(a);if(0==h.gcd(r).compareTo(BigInteger.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(h),this.dmp1=this.d.mod(s),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}}function RSADoPrivate(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var i=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);i.compareTo(n)<0;)i=i.add(this.p);return i.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)}function RSADecrypt(t){var i=parseBigInt(t,16),n=this.doPrivate(i);return null==n?null:pkcs1unpad2(n,this.n.bitLength()+7>>3)}SecureRandom.prototype.nextBytes=rng_get_bytes,RSAKey.prototype.doPublic=RSADoPublic,RSAKey.prototype.setPublic=RSASetPublic,RSAKey.prototype.encrypt=RSAEncrypt,RSAKey.prototype.doPrivate=RSADoPrivate,RSAKey.prototype.setPrivate=RSASetPrivate,RSAKey.prototype.setPrivateEx=RSASetPrivateEx,RSAKey.prototype.generate=RSAGenerate,RSAKey.prototype.decrypt=RSADecrypt;var _cc_00=function(){var i=[214,144,233,254,204,225,61,183,22,182,20,194,40,251,44,5,43,103,154,118,42,190,4,195,170,68,19,38,73,134,6,153,156,66,80,244,145,239,152,122,51,84,11,67,237,207,172,98,228,179,28,169,201,8,232,149,128,223,148,250,117,143,63,166,71,7,167,252,243,115,23,186,131,89,60,25,230,133,79,168,104,107,129,178,113,100,218,139,248,235,15,75,112,86,157,53,30,36,14,94,99,88,209,162,37,34,124,59,1,33,120,135,212,0,70,87,159,211,39,82,76,54,2,231,160,196,200,158,234,191,138,210,64,199,56,181,163,247,242,206,249,97,21,161,224,174,93,164,155,52,26,85,173,147,50,48,245,140,177,227,29,246,226,46,130,102,202,96,192,41,35,171,13,83,78,111,213,219,55,69,222,253,142,47,3,255,106,114,109,108,91,81,141,27,175,146,187,221,188,127,17,217,92,65,31,16,90,216,10,193,49,136,165,205,123,189,45,116,208,18,184,229,180,176,137,105,151,74,12,150,119,126,101,185,241,9,197,110,198,132,24,240,125,236,58,220,77,32,121,238,95,62,215,203,57,72],o=[2746333894,1453994832,1736282519,2993693404],s=[462357,472066609,943670861,1415275113,1886879365,2358483617,2830087869,3301692121,3773296373,4228057617,404694573,876298825,1347903077,1819507329,2291111581,2762715833,3234320085,3705924337,4177462797,337322537,808926789,1280531041,1752135293,2223739545,2695343797,3166948049,3638552301,4110090761,269950501,741554753,1213159005,1684763257];return{_cc_02:function(){var t=new Object;return t.mode="",t.subkey=new Array(32),t},_cc_20:function(t){for(var i=new Array(t.length),n=0;n<t.length;n++)i[n]=t.charAt(n).charCodeAt();return i},_cc_22:function(t,i){return t[i]<<24&4278190080|t[i+1]<<16&16711680|t[i+2]<<8&65280|255&t[i+3]},_cc_23:function(t){var i=new Array(4);return i[0]=t>>>24&255,i[1]=t>>>16&255,i[2]=t>>>8&255,i[3]=255&t,i},_cc_24:function(t,i,n,e,r){for(var o=0;o<r;o++)n[e+o]=t[i+o]},_cc_27:function(t,i){return(4294967295&t)<<i},_cc_17:function(t,i){return this._cc_27(t,i)|t>>>32-i},_cc_05:function(t){return i[t]},_cc_06:function(t){var i,n=new Array(4),e=this._cc_23(t);return n[0]=this._cc_05(e[0]),n[1]=this._cc_05(e[1]),n[2]=this._cc_05(e[2]),n[3]=this._cc_05(e[3]),(i=this._cc_22(n,0))^this._cc_17(i,2)^this._cc_17(i,10)^this._cc_17(i,18)^this._cc_17(i,24)},_cc_11:function(t,i,n,e,r){return t^this._cc_06(i^n^e^r)},_cc_07:function(t){var i,n=new Array(4),e=this._cc_23(t);return n[0]=this._cc_05(e[0]),n[1]=this._cc_05(e[1]),n[2]=this._cc_05(e[2]),n[3]=this._cc_05(e[3]),(i=this._cc_22(n,0))^this._cc_17(i,13)^this._cc_17(i,23)},_cc_08:function(t,i){var n=new Array(4),e=new Array(4),r=0;for(n[0]=this._cc_22(i,0),n[1]=this._cc_22(i,4),n[2]=this._cc_22(i,8),n[3]=this._cc_22(i,12),e[0]=n[0]^o[0],e[1]=n[1]^o[1],e[2]=n[2]^o[2],e[3]=n[3]^o[3];r<32;r++)e[r+4]=e[r]^this._cc_07(e[r+1]^e[r+2]^e[r+3]^s[r]),t[r]=e[r+4]},_cc_04:function(t,i,n,e,r){var o=0,s=new Array(36);for(s[0]=this._cc_22(i,n),s[1]=this._cc_22(i,n+4),s[2]=this._cc_22(i,n+8),s[3]=this._cc_22(i,n+12);o<32;)s[o+4]=this._cc_11(s[o],s[o+1],s[o+2],s[o+3],t[o]),o++;var a=null;a=this._cc_23(s[35]),this._cc_24(a,0,e,r,4),a=this._cc_23(s[34]),this._cc_24(a,0,e,r+4,4),a=this._cc_23(s[33]),this._cc_24(a,0,e,r+8,4),a=this._cc_23(s[32]),this._cc_24(a,0,e,r+12,4)},_cc_10:function(t,i){t.mode=1,this._cc_08(t.subkey,i)},_cc_01:function(t,i){var n;for(t.mode=1,this._cc_08(t.subkey,i),n=0;n<16;n++){var e=t.subkey[n];t.subkey[n]=t.subkey[31-n],t.subkey[31-n]=e}},_cc_03:function(t,i,n,e,r){for(var o=0,s=0;0<n;)this._cc_04(t.subkey,e,o,r,s),o+=16,s+=16,n-=16;return r},_cc_09:function(t,i,n,e,r,o){var s,a=new Array(16);if(1==i)for(var h=0,c=0;0<n;){for(s=0;s<16;s++)o[s]=r[s]^e[s];this._cc_04(t.subkey,o,c,o,c),this._cc_24(o,0,e,c,16),h+=16,c+=16,n-=16}else for(h=0,c=0;0<n;){for(this._cc_24(r,h,a,0,16),this._cc_04(t.subkey,r,h,o,c),s=0;s<16;s++)o[s]=o[s]^e[s];this._cc_24(a,0,e,c,16),c+=16,h+=16,n-=16}},_cc_16:function(t,i,n){for(var e=0;e<n;e++)t.push(n)},_cc_15:function(t,i){if(null==t||0==t.length||null==i||0==i.length)return null;var n=this._cc_02();this._cc_10(n,i);for(var e=t.length,r=0,o=Math.floor(e/16),s=16-e%16,a=new Array(16*(o+1)),h=0;h<=o;h++){var c=new Array(16),u=new Array(16);if(r=16*h,h<o)this._cc_24(t,r,u,0,16);else{var p=e-r;this._cc_24(t,r,u,0,p),this._cc_16(u,p,s)}this._cc_03(n,1,16,u,c),this._cc_24(c,0,a,r,16)}return a},_cc_14:function(t,i){var n=t.length-i;if(0==n)return null;n<0&&(n=16);var e=new Array(n);return this._cc_24(t,0,e,0,n),e},_cc_13:function(t,i){if(null==t||0==t.length||null==i||0==i.length)return null;if(t.length%16!=0)return null;var n=this._cc_02();this._cc_01(n,i);for(var e=t.length,r=0,o=Math.floor(e/16),s=new Array(e),a=0,h=0;h<o;h++){var c=new Array(16);if(r=16*h,this._cc_24(t,r,c,0,16),this._cc_03(n,0,16,c,c),h==o-1){var u=c[c.length-1],p=this._cc_14(c,u);if(null==p){a=r;break}this._cc_24(p,0,s,r,p.length),a=r+p.length}else this._cc_24(c,0,s,r,16)}var l=new Array(a);return this._cc_24(s,0,l,0,a),l}}};function getCCSKeyPad(B,k,n,p){var t=[1,0,4];console.log("ccsk version: "+t[0]+"."+t[1]+"."+t[2]),B.data._cc_sk["hash"+p]&&console.error("ccsk type: "+p+" exist");var T=0,l=B.data._cc_sk.model&&0==B.data._cc_sk.model.indexOf("iPhone X");l&&(T=20);var e=B.data._cc_sk.windowWidth,I=B.data._cc_sk.windowHeight+T,i=_cc_next_uuid().replace(/-/g,""),S={},m={url:n,type:p,keypad:void 0,tap:i,ccsk:i,index:0,onload:function(t){"function"==typeof t&&(this.loadCallback=t)},init:function(r){var t={},s=r.bindinput,a=r.maskchar,o=r.placeholder;r.regex;a=a||"●",t[s]="正在加载...",t[s+"_placeholder"]=o,ccskExtend(B,t),(c=B.data._cc_sk)._ccsk_items=[],null==c.standard&&(c.standard={show:"none",iPhoneX:l,relativeH:T,bgheight:0,height:0,width:0}),null==c.normal&&(c.normal={show:"none",iPhoneX:l,relativeH:T,bgheight:0,height:0,width:0}),null==c.number&&(c.number={show:"none",iPhoneX:l,relativeH:T,bgheight:0,height:0,width:0});var i=c[k];i.show="none",i.iPhoneX=l,c[k]=i,ccskExtend(B,c);var h=this,n=setInterval(function(){console.debug("ccsk status: ["+h.flag+"]"),1==h.flag?(h.loadCallback&&h.loadCallback(!0),t[s]=o,ccskExtend(B,t),clearInterval(n)):9==h.flag&&(h.loadCallback&&h.loadCallback(!1),t[s]="加载失败",ccskExtend(B,t),clearInterval(n))},1e3),e={inputid:s,oninit:function(t){"function"==typeof t&&(this.initCallback=t)},oncomplete:function(t){"function"==typeof t&&(this.compelteCallback=t)},onshow:function(t){"function"==typeof t&&(this.showCallback=t)},onhide:function(t){"function"==typeof t&&(this.hideCallback=t)},onchange:function(t){"function"==typeof t&&(this.changeCallback=t)},show:function(n){var e=this;if(1==h.flag){var t=B.data._cc_sk.bindinputs;if(t.push(e.inputid),ccskExtend(B,{bindinputs:t}),null!=n&&null!=n){var i=n.currentTarget.id;i&&n.touches[0].clientY+54>I-h.keypad.config.height&&(B.setData({_cc_sk_height:h.keypad.config.height,_cc_sk_shelter:!0}),setTimeout(function(){B.setData({_cc_sk_input:i});var t=B.data._cc_sk;t._cc_sk_height=B.data._cc_sk_height,t._cc_sk_shelter=B.data._cc_sk_shelter,t._cc_sk_input=i,ccskExtend(B,t)},50))}B.setData({_cc_sk_show:!0}),h.subparams=r,w(B,k,h.ctx,h.keypad,0),setTimeout(function(){var t=B.data._cc_sk,i=t[k];i.show="block",t[k]=i,t[e.inputid]==o?t[e.inputid]="|":t[e.inputid]=t[e.inputid].replace(/\|/g,"")+"|",t[e.inputid+"Show"]=!0,t.keyboardShow="block",t.keyboardHeight=i.height,t._ccsk_text=t[e.inputid],t._ccsk_items=[],ccskExtend(B,t),B.data._cc_sk[k][e.inputid].showCallback&&B.data._cc_sk[k][e.inputid].showCallback(h.keypad.config.height,n)},10)}},hide:function(t){function i(){for(var t=B.data._cc_sk,i=t.ccsks,n=t.bindinputs,e=0;e<i.length;e++)for(var r=0;r<n.length;r++){var o=B.data._cc_sk[i[e]][n[r]];null!=o&&o.hideCallback&&B.data._cc_sk[n[r]+"Show"]&&o.hideCallback()}for(e=0;e<i.length;e++){var s=t[i[e]];s.show="none",t[i[e]]=s}for(e=0;e<n.length;e++){var a=n[e];"|"==t[a]?t[a]=B.data._cc_sk[a+"_placeholder"]:t[a]=t[a].replace(/\|/g,""),t[a+"Show"]=!1}t.keyboardShow="none",B.setData({_cc_sk_show:!1}),B.data._cc_sk_shelter&&(B.setData({_cc_sk_shelter:!1,_cc_sk_height:0}),t._cc_sk_height=0,t._cc_sk_shelter=!1),ccskExtend(B,t)}1==h.flag&&"none"!=B.data._cc_sk.keyboardShow&&(null!=t&&null!=t?t.touches[0].clientY<I-h.keypad.config.height&&i():i())},clear:function(t){if(1==h.flag&&!(B.data._cc_sk[this.inputid].indexOf(a)<0)){var i=B.data._cc_sk;i[s]=i[s+"_placeholder"];for(var n=B.data._cc_sk.bindinputs,e=[],r=0;r<n.length;r++){var o=n[r];o!=s&&e.push(o)}i.bindinputs=e,S[s]&&(S[s]=void 0),i._ccsk_text=i[s],i._ccsk_items=[],ccskExtend(B,i)}},getPasswordLength:function(){return 1!=h.flag?0:S[s]?S[s].length:0},getPasswordValue:function(){if(1==h.flag&&S[s]&&!(r.minwidth&&S[s].length<r.minwidth||r.maxwidth&&S[s].length>r.maxwidth))return _cc_crypt(h,p,S[s])},isEqual:function(t){if(1!=h.flag)return!1;if(t&&""!=t){var i=S[this.inputid],n=S[t];if(!i||!n||i.length!=n.length)return!1;for(var e=0;e<i.length;e++)if(i[e]!=n[e])return!1;return!0}return!1},isEmpty:function(){if(1==h.flag)return null==S[s]||0==S[s].length}};B.ccskblur=function(t){console.debug("ccsk page touch start......"),console.debug(t),B.data._cc_sk_show&&e.hide(t)};var c,u=(c=B.data._cc_sk)[k];u[s]=e,c[k]=u,ccskExtend(B,c)},bindtap:function(t){var i=this,n=i.subparams,e=n.bindinput,r=(n.minwidth,n.maxwidth),o=n.maskchar;o=o||"●";var s=t.touches[0].clientX,a=t.touches[0].clientY+T,h=I-i.keypad.config.height,c=i.current.key_attrs;S[e]||(S[e]=[]);for(var u=0;u<c.length;u++){var p=c[u],l=p.keyR;if(s>=l.minX&&s<=l.maxX&&a>=h+l.minY&&a<=h+l.maxY){var f=c[u].keyT;if("fh"==f)return;if("fl"==f)return;if(i.ctx.setFillStyle("#4d78a5"),i.ctx.fillRect(p.keyX,p.keyY+T,p.keyW,p.keyH),i.ctx.draw(!0),setTimeout(function(){i.ctx.clearRect(p.keyX,p.keyY+T,p.keyW,p.keyH),i.ctx.draw()},20),console.log(f),"ff"==f)S[e]=S[e].splice(0,S[e].length-1),(m={})[n.bindinput]=B.data._cc_sk[n.bindinput].substring(0,B.data._cc_sk[n.bindinput].length-2)+"|",m._ccsk_text=m[n.bindinput],ccskExtend(B,m),(v=B.data._cc_sk)._ccsk_items.pop(),ccskExtend(B,v),B.data._cc_sk[k][n.bindinput].changeCallback&&B.data._cc_sk[k][n.bindinput].changeCallback(-1);else if("fg"==f){var g=B.data._cc_sk,d=g[k];d.show="none",g[k]=d;var _=g.bindinputs;for(u=0;u<_.length;u++){var b=_[u];"|"==g[b]?g[b]=B.data._cc_sk[b+"_placeholder"]:g[b]=g[b].replace(/\|/g,"")}g.keyboardShow="none",g[n.bindinput+"Show"]=!1,B.setData({_cc_sk_show:!1}),B.data._cc_sk_shelter&&(B.setData({_cc_sk_shelter:!1,_cc_sk_height:0}),g._cc_sk_shelter=!1,g._cc_sk_height=0),ccskExtend(B,g),B.data._cc_sk[k][n.bindinput].compelteCallback&&B.data._cc_sk[k][n.bindinput].compelteCallback(B.data._cc_sk[k][n.bindinput].getPasswordValue()),B.data._cc_sk[k][n.bindinput].hideCallback&&B.data._cc_sk[k][n.bindinput].hideCallback()}else if("fb"==f)w(B,k,i.ctx,i.keypad,0);else if("fc"==f)w(B,k,i.ctx,i.keypad,1);else if("fa"==f)w(B,k,i.ctx,i.keypad,2);else if("fe"==f)w(B,k,i.ctx,i.keypad,3);else if("fh"!=f&&"fl"!=f){if(B.data._cc_sk[n.bindinput].length-1==r)break;var m,v,y=p.value.split("/");if(S[e].push(parseInt(y[0])+i.keypad.index*parseInt(i.keypad.config.b_width)+","+y[1]+","+y[4]),(m={})[n.bindinput]=B.data._cc_sk[n.bindinput].substring(0,B.data._cc_sk[n.bindinput].length-1)+o+"|",m._ccsk_text=m[n.bindinput],ccskExtend(B,m),(v=B.data._cc_sk)._ccsk_items.push(o),ccskExtend(B,v),B.data._cc_sk[k][n.bindinput].changeCallback&&B.data._cc_sk[k][n.bindinput].changeCallback(1),B.data._cc_sk[n.bindinput].length-1==r){B.data._cc_sk[k][n.bindinput].compelteCallback&&B.data._cc_sk[k][n.bindinput].compelteCallback(B.data._cc_sk[k][n.bindinput].getPasswordValue());break}}break}}}};function w(t,i,n,e,r){e.index=r;for(var o=e.kb[r].split("["),s=o[0],a=o[1].split(","),h=[],c=0;c<a.length;c++){var u=a[c].trim().split("/"),p=parseInt(u[0]),l=parseInt(u[1])-T,f=parseInt(u[2]),g=parseInt(u[3]),d={keyX:p,keyY:l,keyW:f,keyH:g,keyG:parseInt(u[4]),keyT:u[5],keyR:{minX:p,maxX:p+f,minY:l,maxY:l+g},value:a[c].trim()};h.push(d)}var _=t.data._cc_sk,b=_[i];b.keypad=s,_[i]=b,ccskExtend(t,_),m.current={kb_img:s,key_attrs:h}}"Standard"==p?B._standardTap=function(t){m.bindtap(t)}:"Normal"==p?B._normalTap=function(t){m.bindtap(t)}:"Number"==p&&(B._numberTap=function(t){m.bindtap(t)}),B._ccsk_scroll=function(t){B.setData({scrollTop:t.detail.scrollTop})},function(){B.data._cc_sk[k]={conf:{}};var t=B.data._cc_sk.ccsks;(t=t||[]).push(k);var i=B.data._cc_sk.bindinputs;ccskExtend(B,{ccsks:t,bindinputs:i=i||[]}),(m.flag=0)<=n.indexOf("?")?n+="&":n+="?",n=n+"DeviceType=1&ScreenSize="+e+","+(I-T)+"&Type="+p,wx.request({url:encodeURI(n),method:"GET",data:{},success:function(t){m.flag=2;var i=t.data.split("]");m.keypad={},m.keypad.inittime=(new Date).getTime().toString();var n=null;"Standard"==p?(n=i[4].split("!!"),m.keypad.kb=[i[0],i[1],i[2],i[3]]):"Normal"==p?(n=i[3].split("!!"),m.keypad.kb=[i[0],i[1],i[2]]):"Number"==p&&(n=i[1].split("!!"),m.keypad.kb=[i[0],i[1]]);var e=n[0].split("/");m.keypad.config={userkey:n[1],modulus:n[2],width:parseInt(e[0]),height:parseInt(e[1]),b_width:parseInt(e[2]),b_height:parseInt(e[3]),h_space:parseInt(e[4]),v_space:parseInt(e[5])};var r=B.data._cc_sk,o=r[k];o.width=parseInt(e[0]),o.height=parseInt(e[1]),o.bgheight=o.height+T,r[k]=o,ccskExtend(B,r),m.ctx=wx.createCanvasContext(k),m.flag=1},fail:function(t){m.flag=9,console.error(t)},complete:function(){}})}();var r=B.data._cc_sk;r["hash"+p]=!0;var o={};return extend(o,m),r[k]=o,ccskExtend(B,r),m}function _cc_next_uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var i=16*Math.random()|0;return("x"==t?i:3&i|8).toString(16)})}function extend(t,i){if(null!=t&&null!=t&&null!=i&&null!=i)for(var n in i)t[n]=i[n]}function ccskExtend(t,i){var n=t.data._cc_sk;extend(n,i),t.setData({_cc_sk:n})}function _cc_crypt(t,i,n){if(n&&""!=n){var e=new Array;e.push(i+",hello,"+(new Date).getTime().toString()+","+t.keypad.inittime),e.push(t.keypad.config.userkey),n instanceof Array?e.push(n.join(";")):e.push(n);var r=new RSAKey;r.setPublic(t.keypad.config.modulus,"10001");var o="01"+sha1(Math.random()+(new Date).getTime()),s=parseBigInt(o,16).toByteArray();try{var a=r.encrypt(o)}catch(t){console.debug(t)}for(var h=_cc_00(),c=h._cc_20(e.join("%%")+"+"),u=h._cc_15(c,s),p=0;p<u.length;p++)u[p]=byte2Hex(u[p]);var l=a+","+u.join("");if(l)return l}}module.exports={getCCSKeyPad:getCCSKeyPad};